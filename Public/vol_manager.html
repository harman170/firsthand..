<!DOCTYPE html>
<html lang="en" ng-app="volunteerApp">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volunteers</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>

    <script>
        let app = angular.module("volunteerApp", []);

        app.controller("volunteerController", function($scope, $http) {
            $scope.volunteers = [];
            $scope.selectedVolunteer = {};

            // Fetch all volunteers
            $scope.fetchVolunteers = function() {
                console.log("Fetching volunteers..."); // Debugging log
                $http.get("/all-volunteers").then(
                    function success(response) {
                        console.log("Data received:", response.data); // Debugging log
                        $scope.volunteers = response.data.map(vol => ({
                            ...vol,
                            profilePicPath: vol.profilePicPath || "default.jpg",
                            idProofPath: vol.idProofPath || "#" // Default placeholder if no ID proof is available
                        }));
                    },
                    function error(err) {
                        console.error("Error fetching volunteers", err);
                    }
                );
            };

            // Show volunteer details in modal
            $scope.viewDetails = function(volunteer) {
                $scope.selectedVolunteer = volunteer;
            };

            $scope.fetchVolunteers();
        });
    </script>

    <style>
        .card {
            border: 2px solid orange;
            min-height: 200px;
            padding: 10px;
        }
        
        .btn-custom {
            background-color: peachpuff;
            border: 1px solid orange;
        }
        
        .card img {
            width: 100%;
            /* Make sure image fits the card */
            height: 150px;
            /* Set a fixed height */
            object-fit: cover;
            /* Ensure proper scaling */
            border-radius: 8px;
            /* Rounded corners for a clean look */
            display: block;
            /* Avoid extra spaces around image */
        }
        
        .modal-body p {
            margin-bottom: 6px;
            font-size: 0.95rem;
        }
        
        .card {
            min-height: 260px;
            /* Ensure all cards are equal */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            /* Keep content evenly spaced */
        }
        
        .card-body {
            text-align: center;
            /* Center-align text */
            padding: 10px;
            /* Adjust padding */
        }
        
        .card-title {
            font-size: 1rem;
            /* Uniform text size */
        }
        
        .card img {
            width: 100%;
            /* Ensures image fills the card width */
            height: 180px;
            /* Adjust height as needed */
            object-fit: contain;
            /* Ensures the full image is visible */
            border-radius: 8px;
            /* Optional: Rounds image corners */
            display: block;
            /* Prevents extra spacing */
            background-color: #f8f9fa;
            /* Optional: Light background for missing images */
        }
        
        .btn-custom {
            background-color: peachpuff;
            border: 1px solid orange;
            font-size: 0.9rem;
            padding: 6px 10px;
        }
    </style>
</head>

<body ng-controller="volunteerController">
    <div class="container mt-4">
        <h5 class="text-center">Volunteer Profiles</h5>
        <div class="row">
            <div class="col-lg-3 col-md-4 col-sm-6 mb-3" ng-repeat="vol in volunteers">

                <div class="card p-3 mb-3">
                    <img ng-src="{{vol.profilePicPath}}" class="card-img-top" alt="Profile Image">
                    <div class="card-body">
                        <h5 class="card-title">{{ vol.txtname }}</h5>
                        <p class="card-text"><strong>City:</strong> {{ vol.city }}</p>
                        <p class="card-text"><strong>Contact:</strong> {{ vol.txtcontact }}</p>
                        <button class="btn btn-custom" data-bs-toggle="modal" data-bs-target="#volunteerModal" ng-click="viewDetails(vol)">View Details</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Volunteer Modal -->
    <div class="modal fade" id="volunteerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Volunteer Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p><strong>Name:</strong> {{ selectedVolunteer.txtname }}</p>
                    <p><strong>Email:</strong> {{ selectedVolunteer.txtemail1 }}</p>
                    <p><strong>Contact:</strong> {{ selectedVolunteer.txtcontact }}</p>
                    <p><strong>Address:</strong> {{ selectedVolunteer.txtaddress }}</p>
                    <p><strong>City:</strong> {{ selectedVolunteer.city }}</p>
                    <p><strong>Gender:</strong> {{ selectedVolunteer.txtGender }}</p>
                    <p><strong>Date of Birth:</strong> {{ selectedVolunteer.txtdob }}</p>
                    <p><strong>Qualification:</strong> {{ selectedVolunteer.txtQual }}</p>
                    <p><strong>Occupation:</strong> {{ selectedVolunteer.txtOccu }}</p>
                    <p><strong>Additional Info:</strong> {{ selectedVolunteer.txtInfo }}</p>
                    <p><strong>ID Proof:</strong>
                        <a ng-href="{{ selectedVolunteer.idProofPath }}" target="_blank" ng-show="selectedVolunteer.idProofPath !== '#'">View ID</a>
                        <span ng-show="selectedVolunteer.idProofPath === '#'">Not Available</span>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>